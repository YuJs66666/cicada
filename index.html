<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>暗夜猎手：蝉 - 视觉剧情进化版</title>
    <style>
        body { margin: 0; background: #000; color: #1a4d1a; font-family: 'STHeiti', 'Microsoft YaHei', sans-serif; overflow: hidden; height: 100vh; cursor: none; }
        #info { position: absolute; top: 30px; text-align: center; pointer-events: none; width: 100%; z-index: 10; }
        #msg { font-size: 24px; color: #6aff6a; letter-spacing: 5px; text-shadow: 0 0 15px #000; transition: all 0.8s ease-out; /* 更平滑的过渡 */ }
        #loader { color: #555; font-size: 14px; }
        .stats { margin-top: 15px; font-size: 14px; color: #2d5a2d; opacity: 0.7; }
        canvas { display: block; }
    </style>
</head>
<body>

<div id="info">
    <div id="loader">感知森林的呼吸...</div>
    <div id="msg" style="display:none;">[ 点击屏幕 屏息凝神 ]</div>
    <div id="stats" style="display:none;" class="stats">
        深处: <span id="lvl">1</span> 层 | 标本: <span id="score">0</span>/3
    </div>
</div>
<canvas id="gameCanvas"></canvas>

<script>
/**
 * 暗夜猎手 - 视觉剧情进化版
 * 核心功能：
 * 1. 声音：HRTF 3D 空间定位，蝉鸣/背景音真实采样。
 * 2. 视觉：动态萤火虫、手电光晕、呼吸准星、捕获闪光。
 * 3. 机制：未击中触发“惊飞”，关卡难度递增。
 * 4. 剧情：关卡切换时显示剧情文字。
 */

let audioCtx, forestBuffer, cicadaBuffer;
let bgNode,
